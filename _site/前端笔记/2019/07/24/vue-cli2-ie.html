<!DOCTYPE html>
<html lang="en"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content=""><title>vue-cli2 兼容 IE 浏览器的不完全踩坑之旅 | 柚子胖鸡_</title><meta name="baidu-site-verification" content="code-QQXB3LWw5E" />
<script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?1d4b09c687aa7d9e66a6041d5b5f58f1";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
</script>

  <meta name="keywords" content="">
  <meta name="description" content="JaimeCheng's Blog，记录前端笔记、生活杂事、读书随笔等。"><link rel="stylesheet" href="/assets/main.css?v=0.2.5" />
<link rel="stylesheet" href="/assets/my.css" />
<script src="/assets/main.js?v=0.2.5" defer></script><link rel="stylesheet" href="/assets/css/tomorrow.css" />
<script src="/assets/js/highlight.js"></script></head>
<a href="https://github.com/JaimeCheng" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><body class="body-post">
    <a href="/" class="logo"><img src="/img/logo.png" class="logo_img"><h1>柚子胖鸡_</h1>
</a>
<!-- --><main class="post__wrapper"><nav class="top-nav">

<a href="/" target="" class="nav-link ">首页</a>


<a href="/about/" target="" class="nav-link ">关于</a>


<a href="/archive/" target="" class="nav-link ">归档</a>


<a href="/javascript_v3/" target="_blank" class="nav-link">红宝书</a></nav><div class="post__top_navs clearfix">
    <nav class="post__archive_path"><a href="/" id="archiveBtn">
        <div class="post__archive_icon">
          <svg width="40" height="40">
            <circle class="circle-progress" r="18" cy="20" cx="20"  stroke-linejoin="round" stroke-linecap="round" />
          </svg>
          <span class="post__archive_icon"></span>
        </div>
        Home
      </a>
    </nav>
  </div>
  <article class="post">
    <header class="post__header">
      <h1 class="post__title">vue-cli2 兼容 IE 浏览器的不完全踩坑之旅</h1>
      <div class="post__meta">
        <time>2019-07-24 10:15</time>
      </div>
    </header>
    <div class="post__content content">
      <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#背景">背景</a></li>
<li class="toc-entry toc-h3"><a href="#1-老生常谈的-es6-语法兼容通常表现为页面空白--babel-polyfill">1. 老生常谈的 ES6 语法兼容（通常表现为页面空白） —— babel-polyfill</a></li>
<li class="toc-entry toc-h3"><a href="#2-ie-浏览器-post-请求没反应">2. IE 浏览器 POST 请求没反应</a></li>
<li class="toc-entry toc-h3"><a href="#3-ie9-请求报错-拒绝访问">3. IE9 请求报错 “拒绝访问”</a></li>
<li class="toc-entry toc-h3"><a href="#4-ie-浏览器-get-请求缓存的问题">4. IE 浏览器 GET 请求缓存的问题</a></li>
</ul><p>IE 浏览器真是不合群又不懂事，让无数开发者操碎了心啊···
本文会持续补充遇到的相关IE兼容问题和解决方案！（兼容&gt;=IE9）</p>

<h3 id="背景">
<a class="anchor" href="#%E8%83%8C%E6%99%AF" aria-hidden="true"><span class="octicon octicon-link"></span></a>背景</h3>
<p><strong>生产环境</strong>
<strong>vue 2.5.10 index.html中以cdn方式引入</strong>
<strong>axios 0.18.0</strong></p>

<h3 id="1-老生常谈的-es6-语法兼容通常表现为页面空白--babel-polyfill">
<a class="anchor" href="#1-%E8%80%81%E7%94%9F%E5%B8%B8%E8%B0%88%E7%9A%84-es6-%E8%AF%AD%E6%B3%95%E5%85%BC%E5%AE%B9%E9%80%9A%E5%B8%B8%E8%A1%A8%E7%8E%B0%E4%B8%BA%E9%A1%B5%E9%9D%A2%E7%A9%BA%E7%99%BD--babel-polyfill" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. 老生常谈的 ES6 语法兼容（通常表现为页面空白） —— babel-polyfill</h3>
<p>安装依赖</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install </span>babel-polyfill <span class="nt">--save-dev</span>
</code></pre></div></div>
<p>在 <code class="language-plaintext highlighter-rouge">webpack.base.conf.js</code> 中按照以下内容修改</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">app</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">babel-polyfill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">./src/main.js</span><span class="dl">'</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>在入口文件 <code class="language-plaintext highlighter-rouge">main.js</code> 引入
我其实没有引入，<code class="language-plaintext highlighter-rouge">babel-polyfill</code> 仍然生效了，你们可以试试；</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="dl">"</span><span class="s2">babel-polyfill</span><span class="dl">"</span>
</code></pre></div></div>
<h3 id="2-ie-浏览器-post-请求没反应">
<a class="anchor" href="#2-ie-%E6%B5%8F%E8%A7%88%E5%99%A8-post-%E8%AF%B7%E6%B1%82%E6%B2%A1%E5%8F%8D%E5%BA%94" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. IE 浏览器 POST 请求没反应</h3>
<p>安装依赖</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install </span>url-search-params-polyfill <span class="nt">--save</span>
</code></pre></div></div>
<p>在入口文件 <code class="language-plaintext highlighter-rouge">main.js</code> 引入</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="dl">'</span><span class="s1">url-search-params-polyfill</span><span class="dl">'</span>
</code></pre></div></div>

<h3 id="3-ie9-请求报错-拒绝访问">
<a class="anchor" href="#3-ie9-%E8%AF%B7%E6%B1%82%E6%8A%A5%E9%94%99-%E6%8B%92%E7%BB%9D%E8%AE%BF%E9%97%AE" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. IE9 请求报错 “拒绝访问”</h3>
<p>虽然服务器那边已经设置了<code class="language-plaintext highlighter-rouge">
Access-Control-Allow-Origin: *;</code>，查阅资料发现 ie8/9 不支持cors跨域方案，<a href="%5Bhttps://docs.microsoft.com/zh-cn/previous-versions//dd573303(v=vs.85)%5D(https://docs.microsoft.com/zh-cn/previous-versions//dd573303(v=vs.85))">具体参考这里</a>
<strong>方法一（不切实际）</strong>
设置浏览器安全属性，启用【通过域访问数据源】选项；但肯定不能要求用户去设置啊…
<img src="https://upload-images.jianshu.io/upload_images/3981371-2f19cfa88e36283c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="通过域访问数据源">
<strong>方法二</strong>
服务器设置反向代理，但没有尝试，不好意思..
或者：
判断浏览器是IE9的话，api发送请求到本域，本域将请求转发至目标服务器
<strong>其他</strong>
<a href="%5Bhttps://github.com/axios/axios/pull/182%5D(https://github.com/axios/axios/pull/182)">参考这里</a>
<strong>开发环境的解决方法</strong>
如果是开发环境的话，就给webpack配置代理就可以解决跨域；
在 <code class="language-plaintext highlighter-rouge">config/index.js</code> 添加如下：</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module.exports = {
  dev: {
    ...
    proxyTable: {
      '/api':{
        target: 'https://www.domain.com/api',  // 后台api地址
        changeOrigin: true,
        pathRewrite: {
          '/api': ''
        }
      }
    }
  }
}
</code></pre></div></div>
<p>这里注意 <code class="language-plaintext highlighter-rouge">config/dev.env.js</code> 中如果配置了请求URL的 <code class="language-plaintext highlighter-rouge">BASE_API</code> ，这个值也应该换成 <code class="language-plaintext highlighter-rouge">/api</code>；</p>

<h3 id="4-ie-浏览器-get-请求缓存的问题">
<a class="anchor" href="#4-ie-%E6%B5%8F%E8%A7%88%E5%99%A8-get-%E8%AF%B7%E6%B1%82%E7%BC%93%E5%AD%98%E7%9A%84%E9%97%AE%E9%A2%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. IE 浏览器 GET 请求缓存的问题</h3>
<p>我说我明明刚添加完一项数据，为什么再打开页面刷新的时候没有呢？？
都是ie这不合群的浏览器缓存get请求搞的鬼！
现提供两种我已经测试过的方法；
以下两种方法都是在封装axios请求拦截器中修改；</p>

<p><strong>方法一</strong>
设置请求头，禁止缓存</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">service</span> <span class="o">=</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
     <span class="dl">'</span><span class="s1">Cache-Control</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">no-cache</span><span class="dl">'</span><span class="p">,</span>
     <span class="dl">'</span><span class="s1">Pragma</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">no-cache</span><span class="dl">'</span>
   <span class="p">}</span> 
<span class="p">})</span>
</code></pre></div></div>
<p><strong>方法二</strong>
get请求的参数中增加时间戳或是随机数</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">service</span><span class="p">.</span><span class="nx">interceptors</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
  <span class="nx">config</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">get</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">config</span><span class="p">.</span><span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">config</span><span class="p">.</span><span class="nx">params</span><span class="p">,</span>
        <span class="na">_t</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">)</span>
</code></pre></div></div>

    </div>
  </article><aside class="post__contact"><h4><a href="/about/">JaimeCheng</a></h4>
  
<div class="icon__list"><a href="mailto:JaimeCheng@gmail.com" class="icon__link" target="_blank"><svg class="icon__stroke" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
  <polyline points="22,6 12,13 2,6"></polyline>
</svg>
</a><a href="https://github.com/JaimeCheng" class="icon__link" target="_blank"><svg viewBox="0 0 64 64" class="icon__fill">
  <path stroke-width="0" d="M32 0 C14 0 0 14 0 32 0 53 19 62 22 62 24 62 24 61 24 60 L24 55 C17 57 14 53 13 50 13 50 13 49 11 47 10 46 6 44 10 44 13 44 15 48 15 48 18 52 22 51 24 50 24 48 26 46 26 46 18 45 12 42 12 31 12 27 13 24 15 22 15 22 13 18 15 13 15 13 20 13 24 17 27 15 37 15 40 17 44 13 49 13 49 13 51 20 49 22 49 22 51 24 52 27 52 31 52 42 45 45 38 46 39 47 40 49 40 52 L40 60 C40 61 40 62 42 62 45 62 64 53 64 32 64 14 50 0 32 0 Z" />
</svg>
</a><a href="https://gitee.com/JaimeCheng" class="icon__link" target="_blank"><svg viewBox="0 0 1024 1024" class="icon__fill">
  <path stroke-width="0" d="M512 992C246.90666687 992 32 777.09333313 32 512S246.90666687 32 512 32s480 214.90666688 480 480-214.90666688 480-480 480z m242.95999969-533.33333344l-272.58666656 0.01333313c-13.09333313 0-23.70666656 10.61333344-23.70666657 23.69333344l-0.02666625 59.26666687c0 13.09333313 10.60000031 23.70666656 23.69333344 23.70666656h165.96c13.09333313 0 23.70666656 10.60000031 23.70666656 23.69333344v11.85333375A71.10666656 71.10666656 0 0 1 600.89333375 672.00000031h-225.20000062a23.70666656 23.70666656 0 0 1-23.70666657-23.69333343V423.12000031a71.10666656 71.10666656 0 0 1 71.10666657-71.10666656L754.89333313 351.99999969c13.09333313 0 23.69333344-10.60000031 23.70666656-23.69333344L778.66666625 269.06666656c0-13.09333313-10.60000031-23.70666656-23.6933325-23.71999968l-331.8666675 0.01333312C324.93333312 245.34666687 245.33333375 324.94666625 245.33333375 423.12000031v331.83999938c0 13.09333313 10.61333344 23.70666656 23.70666656 23.70666656H618.66666688c88.37333344 0 160.00000031-71.62666687 159.99999937-159.99999937V482.37333313c0-13.08-10.61333344-23.69333344-23.70666656-23.69333344z" />
</svg>
</a><a href="https://weibo.com/JaimeCheng" class="icon__link" target="_blank"><svg viewBox="0 0 1024 1024" class="icon__fill">
  <path d="M385.718857 733.696c16.018286-26.294857 7.424-56.576-19.419428-67.986286-25.709714-10.861714-60.013714 0.585143-75.995429 25.709715-16.566857 25.709714-8.557714 55.990857 17.152 67.986285 26.294857 11.995429 61.696 0.585143 78.299429-25.709714z m53.723429-69.12c5.705143-10.276571 2.304-21.723429-8.009143-25.709714a24.941714 24.941714 0 0 0-28.562286 10.861714c-5.705143 10.276571-2.852571 21.138286 7.424 25.709714a24.356571 24.356571 0 0 0 29.147429-10.861714z m99.401143 61.147429c-34.304 77.714286-133.705143 119.990857-218.294858 92.562285-81.700571-26.294857-116.004571-106.861714-80.566857-179.419428 35.437714-70.838857 126.281143-110.848 206.848-90.294857 84.004571 21.723429 126.281143 100.571429 92.013715 177.152z m178.285714-91.428572c-10.861714-111.433143-157.147429-188.013714-326.838857-171.446857-169.728 17.152-297.728 120.576-286.866286 232.009143s157.147429 188.013714 326.838857 171.446857c169.728-17.152 297.728-120.576 286.866286-232.009143z m176.018286 2.267429c0 128.585143-185.161143 290.304-463.433143 290.304C217.161143 926.866286 0 824.027429 0 654.299429c0-88.576 55.990857-190.866286 152.576-287.414858 129.133714-129.133714 279.442286-187.428571 336.018286-130.852571 25.161143 24.576 27.428571 67.986286 11.446857 119.442286-8.009143 26.294857 24.576 11.446857 24.576 11.995428 104.009143-43.995429 194.852571-46.299429 227.986286 1.133715 17.700571 25.161143 16.018286 60.562286 0 101.705142-7.424 18.870857 2.304 21.723429 16.566857 26.294858 58.843429 18.285714 124.013714 62.281143 124.013714 139.995428z m-42.276572-356.571429a131.401143 131.401143 0 0 1 27.428572 129.133714 33.572571 33.572571 0 1 1-64-20.553142c6.838857-21.723429 2.304-45.714286-13.714286-63.414858s-39.424-24.576-61.147429-20.004571c-18.285714 3.986286-36.571429-7.424-40.009143-25.709714a33.462857 33.462857 0 0 1 25.709715-40.009143 130.669714 130.669714 0 0 1 125.696 40.557714z m103.424-93.147428c67.437714 74.276571 85.138286 175.981714 56.576 265.142857-6.838857 20.553143-28.562286 32-49.152 25.161143s-32-28.562286-25.709714-49.152c20.553143-63.414857 8.009143-136.009143-40.009143-188.562286a192.804571 192.804571 0 0 0-183.442286-59.428572c-21.138286 4.571429-42.276571-9.142857-46.848-30.281142s9.142857-41.728 30.281143-46.299429c92.013714-19.419429 190.866286 8.557714 258.304 83.419429z" stroke-width="0"></path>
</svg>
</a></div>
</aside></main><script>hljs.initHighlightingOnLoad();</script><footer class="site-footer">
  © 2020<a href="/">柚子胖鸡_</a>. Theme<a href="https://github.com/erlzhang/jekyll-theme-persephone" target="_blank">Persephone</a>
</footer>

  </body>
</html>
